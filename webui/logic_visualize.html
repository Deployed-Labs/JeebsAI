<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Jeebs Logic Graph</title>
        <script
            type="text/javascript"
            src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"
        ></script>
        <style>
            body {
                margin: 0;
                padding: 0;
                overflow: hidden;
                font-family: sans-serif;
                background: #181c24;
                color: #f3f3f3;
            }
            #mynetwork {
                width: 100vw;
                height: 100vh;
            }
            #loading {
                position: absolute;
                top: 20px;
                left: 20px;
                background: #23283a;
                padding: 10px;
                border-radius: 4px;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
                z-index: 10;
                color: #7fffd4;
                border: 1px solid #7fffd4;
            }
            .back-btn {
                position: absolute;
                top: 20px;
                right: 20px;
                background: #23283a;
                color: #7fffd4;
                padding: 10px 20px;
                text-decoration: none;
                border-radius: 6px;
                font-weight: bold;
                z-index: 10;
                border: 1px solid #7fffd4;
                transition: background 0.2s;
            }
            .back-btn:hover {
                background: #2a3044;
            }
        </style>
    </head>
    <body>
        <div id="loading">Loading Logic Graph...</div>
        <a href="/webui/admin_dashboard.html" class="back-btn"
            >Back to Dashboard</a
        >
        <div id="mynetwork"></div>

        <script type="text/javascript">
            async function loadGraph() {
                try {
                    const res = await fetch("/api/brain/logic_graph");
                    const data = await res.json();

                    const container = document.getElementById("mynetwork");
                    const nodes = new vis.DataSet(data.nodes);
                    const edges = new vis.DataSet(data.edges);

                    const graphData = { nodes: nodes, edges: edges };
                    const options = {
                        nodes: {
                            font: { size: 14, color: "#f3f3f3" },
                            borderWidth: 1,
                            color: {
                                background: "#23283a",
                                border: "#7fffd4",
                                highlight: {
                                    background: "#2a3044",
                                    border: "#7fffd4",
                                },
                            },
                        },
                        edges: {
                            width: 1,
                            color: { color: "#555", highlight: "#7fffd4" },
                            smooth: { type: "continuous" },
                            font: {
                                align: "middle",
                                size: 12,
                                color: "#aaa",
                                strokeWidth: 0,
                            },
                        },
                        physics: {
                            stabilization: false,
                            barnesHut: {
                                gravitationalConstant: -2000,
                                springConstant: 0.04,
                                springLength: 150,
                            },
                        },
                    };

                    new vis.Network(container, graphData, options);
                    document.getElementById("loading").style.display = "none";
                } catch (e) {
                    document.getElementById("loading").innerText =
                        "Error loading graph: " + e;
                    document.getElementById("loading").style.color = "#ff6b6b";
                }
            }
            loadGraph();
        </script>
    </body>
</html>
