<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Brain Visualization â€” JeebsAI</title>
<script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet"/>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#07121a;color:#e8edf4;font-family:'Space Grotesk',sans-serif;overflow:hidden}
#mynetwork{width:100vw;height:100vh}
#loading{position:fixed;top:20px;left:20px;background:rgba(15,22,30,0.9);backdrop-filter:blur(12px);padding:14px 20px;border-radius:10px;border:1px solid rgba(83,216,251,0.2);color:#53d8fb;z-index:10;font-size:0.95em;display:flex;align-items:center;gap:10px}
#loading .spinner{width:18px;height:18px;border:2px solid rgba(83,216,251,0.2);border-top-color:#53d8fb;border-radius:50%;animation:spin .6s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.back-btn{position:fixed;top:20px;right:20px;background:rgba(15,22,30,0.9);backdrop-filter:blur(12px);color:#53d8fb;padding:10px 18px;text-decoration:none;border-radius:10px;font-weight:600;z-index:10;border:1px solid rgba(83,216,251,0.2);transition:all .2s}
.back-btn:hover{background:rgba(83,216,251,0.1);border-color:#53d8fb}
</style>
</head>
<body>
<nav id="topnav"></nav>
<div class="shell" style="padding-top:60px;max-width:1200px">
  <div class="card card-glow" style="margin-bottom:24px;text-align:center">
    <h1 style="margin-bottom:8px">Brain Visualization</h1>
    <p class="text-muted">Interactive graph of the JeebsAI knowledge network.</p>
  </div>
  <div class="card" style="margin-bottom:24px;position:relative;min-height:600px">
    <div id="loading" style="position:absolute;top:20px;left:20px;background:rgba(15,22,30,0.9);backdrop-filter:blur(12px);padding:14px 20px;border-radius:10px;border:1px solid rgba(83,216,251,0.2);color:#53d8fb;z-index:10;font-size:0.95em;display:flex;align-items:center;gap:10px"><div class="spinner"></div> Loading Brain Graph&hellip;</div>
    <div id="mynetwork" style="width:100%;height:600px"></div>
  </div>
</div>

<script src="/webui/auth.js"></script>
<script>
async function loadGraph(){
  try{
    var res=await safeFetch("/api/brain/visualize");
    if(!res.ok){var body=await res.text();throw new Error("HTTP "+res.status+(body?": "+body:""));}
    var data=await res.json();
    var container=document.getElementById("mynetwork");
    var nodes=new vis.DataSet(Array.isArray(data.nodes)?data.nodes:[]);
    var edges=new vis.DataSet(Array.isArray(data.edges)?data.edges:[]);
    var options={
      nodes:{shape:"dot",size:16,font:{size:14,color:"#e8edf4"},borderWidth:2,color:{background:"#1a2a3a",border:"#53d8fb",highlight:{background:"#1f3548",border:"#53d8fb"}}},
      edges:{width:1,color:{color:"#2b3a4a",highlight:"#53d8fb"},smooth:{type:"continuous"}},
      physics:{stabilization:false,barnesHut:{gravitationalConstant:-8000,springConstant:0.04,springLength:95}},
      interaction:{hover:true,tooltipDelay:200}
    };
    new vis.Network(container,{nodes:nodes,edges:edges},options);
    document.getElementById("loading").style.display="none";
  }catch(e){
    var l=document.getElementById("loading");l.innerHTML="Error loading graph: "+e;l.style.color="#ff6b6b";
  }
}
loadGraph();
</script>
</body>
</html>
